<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>SQRL | sqrl-redis-functions </title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    

    <!-- fonts -->
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Ubuntu:300,400,500,600,700" rel="stylesheet">

    <!-- stylesheets -->
    <link rel="stylesheet" href="/sqrl/style/doc.css">

    <!-- favicon -->
    <link rel="icon" href="/sqrl/images/favicon.ico">

    

  <meta name="generator" content="Hexo 6.3.0"></head>
  <body>

   <script>window.__INITIAL_STATE__ = {"page":{"title":"sqrl-redis-functions","path":"packages/sqrl-redis-functions.html"},"data":{"navigation":{"logo":{"text":"SQRL Documentation","type":"link","path":"index.html"},"main":[{"text":"Introduction","type":"link","path":"index.html"},{"text":"Motivation","type":"link","path":"motivation.html"},{"text":"Tutorial","type":"link","path":"tutorial.html"},{"text":"Why is it unique?","type":"link","path":"unique.html"},{"text":"FAQ","type":"link","path":"faq.html"},{"text":"Examples","type":"label","children":[{"text":"Redis Database","type":"link","path":"examples/redis.html"},{"text":"REPL","type":"link","path":"examples/repl.html"},{"text":"Wikipedia","type":"link","path":"examples/wikipedia.html"}]},{"text":"Concepts","type":"label","children":[{"text":"Entities","type":"link","path":"language/entities.html"},{"text":"Labels","type":"link","path":"language/labels.html"},{"text":"Simple Counters","type":"link","path":"counters/simple.html"},{"text":"Unique Counters","type":"link","path":"counters/unique.html"},{"text":"Rate limiters","type":"link","path":"counters/ratelimit.html"},{"text":"Sessionization","type":"link","path":"counters/session.html"},{"text":"Text Pattern Matching","type":"link","path":"language/textpattern.html"},{"text":"Include and Where Clauses","type":"link","path":"language/where.html"},{"text":"Cost Optimisation","type":"link","path":"language/cost.html"}]},{"text":"Standard Library","type":"label","children":[{"text":"Assert Functions","type":"link","path":"stdlib/assert.html"},{"text":"Bool Functions","type":"link","path":"stdlib/bool.html"},{"text":"Control Functions","type":"link","path":"stdlib/control.html"},{"text":"Data Functions","type":"link","path":"stdlib/data.html"},{"text":"Date-time Functions","type":"link","path":"stdlib/date-time.html"},{"text":"Entity Functions","type":"link","path":"stdlib/entity.html"},{"text":"List Functions","type":"link","path":"stdlib/list.html"},{"text":"Math Functions","type":"link","path":"stdlib/math.html"},{"text":"String Functions","type":"link","path":"stdlib/string.html"},{"text":"Type Functions","type":"link","path":"stdlib/type.html"}]},{"text":"Function Packages","type":"label","children":[{"text":"sqrl-cli-functions","type":"link","path":"packages/sqrl-cli-functions.html"},{"text":"sqrl-load-functions","type":"link","path":"packages/sqrl-load-functions.html"},{"text":"sqrl-redis-functions","type":"link","path":"packages/sqrl-redis-functions.html"},{"text":"sqrl-text-functions","type":"link","path":"packages/sqrl-text-functions.html"}]},{"text":"Defining Functions","type":"label","children":[{"text":"Simple Functions","type":"link","path":"functions/simple.html"},{"text":"Statements","type":"link","path":"functions/statement.html"},{"text":"When Clauses","type":"link","path":"functions/when.html"},{"text":"Custom Functions","type":"link","path":"functions/custom.html"}]},{"text":"Production Deployments","type":"label","children":[{"text":"Sync and Async","type":"link","path":"deployment/async.html"},{"text":"Http Server","type":"link","path":"deployment/server.html"},{"text":"Queues","type":"link","path":"deployment/queue.html"}]},{"text":"External Resources","type":"label"},{"text":"API Reference","type":"link","path":"reference/index.html"},{"text":"Discord Chat","type":"link","path":"https://discord.gg/mMJwWT6"},{"text":"View on GitHub","type":"link","path":"https://github.com/sqrl-lang/sqrl"}]}},"config":{"timezone":"UTC","root":"/sqrl/","time_format":"HH:mm:ss","theme":"sqrl-hexo-theme-doc","theme_config":{"swagger_ui":{"version":2,"permalinks":true,"api_explorer":true,"download":"Download specification","show_extensions":false,"deep_linking":true,"display_operation_id":false,"doc_expansion":"none"},"search":{"skip":false,"background":false,"route":"/lunr.json"},"favicon":"images/favicon.ico"}}}</script>

    <div id="react-navigation-root"><div class="doc-navigation" data-reactroot=""><nav class="doc-navbar"><a href="/sqrl/index.html" class="doc-navbar__logo"><img src="/sqrl/images/logo.png" class="doc-navbar__logo__img"/><span class="doc-navbar__logo__text">SQRL Documentation</span></a><i class="dc-icon dc-icon--close dc-icon--interactive doc-sidebar-close doc-navbar__sidebar-close doc-navbar__sidebar-close--desktop"></i><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-navbar__sidebar-toggle"></i></nav><nav class="doc-sidebar"><div class="doc-sidebar__vertical-menu"><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-sidebar-toggle--primary doc-sidebar__vertical-menu__item"></i><i class="dc-icon dc-icon--search dc-icon--interactive doc-sidebar__vertical-menu__item doc-sidebar__vertical-menu__item--primary"></i></div><div class="doc-sidebar-content"><div class="doc-sidebar__search-form"></div><ul class="doc-sidebar-list"></ul></div></nav></div></div>
    <div class="doc-content">
  <div class="dc-page">
    <div class="dc-card">
      <div id="react-search-results-root"></div>
      <div id="page-content" class="doc-formatting">
        <html><head></head><body><h1 id="sqrl-redis-functions"><a href="#sqrl-redis-functions" class="headerlink" title="sqrl-redis-functions"></a>sqrl-redis-functions</h1><p>This package implements some counters on top of redis.</p>
<p>The <code>count</code>, <code>countUnique</code> and <code>trending</code> functions use buckets to approximate the value. The <code>countUnique</code> function also uses the HyperLogLog algorithm to approximate the unique set count for each bucket.</p>
<p>Future work could include switching to the <a target="_blank" rel="noopener" href="https://hal.archives-ouvertes.fr/hal-00465313/document">Sliding HyperLogLog</a> algorithm for <code>countUnique</code>. This would enable it to count all time windows together with better accuracy (no need for bucketing) and smaller space requirements.</p>
<p><strong>Note</strong>: Only the counts that are present in the source file are tracked. This means that all the counts will begin at zero when each counter is first introduced to your source.</p>
<h2 id="addLabel"><a href="#addLabel" class="headerlink" title="addLabel"></a>addLabel</h2><p><strong>addLabel</strong>(entity | entity list, label)</p>
<p>Adds the provided label to the specified entities</p>
<h2 id="count"><a href="#count" class="headerlink" title="count"></a>count</h2><p><strong>count</strong>(BY Feature[, …] [WHERE Condition] [LAST Timespan])</p>
<p>Returns the streaming count for the given window</p>
<p>Timespans: LAST [X] SECONDS/MINUTES/HOURS/DAYS/WEEKS<br>           DAY OVER DAY, DAY OVER WEEK, WEEK OVER WEEK<br>           TOTAL</p>
<h2 id="countUnique"><a href="#countUnique" class="headerlink" title="countUnique"></a>countUnique</h2><p><strong>countUnique</strong>(Feature[, …] [GROUP BY Feature[, …]] [WHERE Condition] [LAST Duration] [BEFORE ACTION])</p>
<p>Performs a sliding window unique set count</p>
<h2 id="entity"><a href="#entity" class="headerlink" title="entity"></a>entity</h2><p><strong>entity</strong>(type, key)</p>
<p>Create an entity of the given type</p>
<h2 id="entityList"><a href="#entityList" class="headerlink" title="entityList"></a>entityList</h2><p><strong>entityList</strong>(type, keys)</p>
<p>Create a list of entities of the given type</p>
<h2 id="hasLabel"><a href="#hasLabel" class="headerlink" title="hasLabel"></a>hasLabel</h2><p><strong>hasLabel</strong>(entity, label)</p>
<p>Returns true if the provided entity has the given label</p>
<h2 id="rateLimit"><a href="#rateLimit" class="headerlink" title="rateLimit"></a>rateLimit</h2><p><strong>rateLimit</strong>(BY Feature[, …] [MAX Tokens] EVERY Duration [REFILL Count] [TAKE Count] [STRICT] [WHERE Condition])</p>
<p>Returns the number of tokens left in the token bucket ratelimiter before decrementing</p>
<h2 id="rateLimited"><a href="#rateLimited" class="headerlink" title="rateLimited"></a>rateLimited</h2><p><strong>rateLimited</strong>(BY Feature[, …] [MAX Tokens] EVERY Duration [REFILL Count] [TAKE Count] [STRICT] [WHERE Condition])</p>
<p>Returns true if the token bucket rate limiter has no tokens left, false otherwise</p>
<h2 id="rateLimitedValues"><a href="#rateLimitedValues" class="headerlink" title="rateLimitedValues"></a>rateLimitedValues</h2><p><strong>rateLimitedValues</strong>(BY Feature[, …] [MAX Tokens] EVERY Duration [REFILL Count] [TAKE Count] [STRICT] [WHERE Condition])</p>
<p>Returns the values that were rate limited by the token bucket rate limiter</p>
<h2 id="removeLabel"><a href="#removeLabel" class="headerlink" title="removeLabel"></a>removeLabel</h2><p><strong>removeLabel</strong>(entity | entity list, label)</p>
<p>Removes the provided label to the specified entities</p>
<h2 id="sessionize"><a href="#sessionize" class="headerlink" title="sessionize"></a>sessionize</h2><p><strong>sessionize</strong>(BY Feature[, …] [MAX Tokens] EVERY Duration [REFILL Count] [TAKE Count] [STRICT] [WHERE Condition])</p>
<p>Creates a new session using a token bucket rate limiter</p>
<h2 id="trending"><a href="#trending" class="headerlink" title="trending"></a>trending</h2><p><strong>trending</strong>(Feature[, …] [WHERE Condition] [WITH MIN Count EVENTS] (Timespan))</p>
<p>Returns values whose counts have gone up by an order of magnitude</p>
<p>Timespans: DAY OVER DAY, DAY OVER WEEK, DAY OVER FULL WEEK</p>
</body></html>
        <div id="react-support-footer-root"></div>
      </div>
    </div>
  </div>
</div>

    


    

    <!-- js vendors -->
    <script src="//code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/lunr.js/2.1.0/lunr.min.js"></script>

    <!-- js source  -->
    <script src="/sqrl/script/doc.js"></script>

    

  </body>
</html>
